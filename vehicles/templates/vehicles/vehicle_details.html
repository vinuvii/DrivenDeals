{% extends 'base.html' %}
{% load static %}

{% block extra_head %}
<style>
    .vehicle-header {
        width: 100%;
        height: 300px; /* Adjust height as needed */
        overflow: hidden;
        position: relative;
        margin-top: -150px;
    }

    .vehicle-header img {
        width: 100%;
        height: 100%; /* Ensure the image fills its container */
        object-fit: cover; /* Ensures the image covers the entire container */
        position: absolute; /* Position image absolutely within its container */
        top: 0;
        left: 0;
    }

    .vehicle-overlay {
        font-family: 'Open Sans', 'Titillium Web', 'PT Sans', Arial, sans-serif;
        position: absolute;
        top: 180px;
        left: 180px;
        color: white;
        padding: 5px 10px;
        font-size: 36px;
        font-weight: bold;
        z-index: 10; /* Ensure overlay is above the image */
    }

    .vehicle-details-section {
        background-color: #f9f9f9;
        padding: 40px 0;
    }

    .vehicle-details-section__head-title {
        position: relative;
    }

    .vehicle-details-section__head-title::before {
        content: '';
        position: absolute;
        top: 0;
        left: -20px; /* Adjust this value to control the distance from the text */
        width: 5px; /* Adjust this value to control the thickness of the line */
        height: 100%;
        background-color: #de483d; /* Red color */
    }

    .vehicle-details-section__head h1,
    .vehicle-details-section__head h3 {
        margin: 10px 0;
        padding-left: 10px; /* Add padding to separate text from line */
    }

    .vehicle-details-section__head-price {
        text-align: right;
        margin-top: 20px; /* Adjust spacing */
    }

    .vehicle-details-section__head-price-num {
        font-size: 30px;
        font-weight: bold;
        color: #ffffff;
        background-color: #de483d; /* Background color */
        display: inline-block;
        padding: 10px 25px;
        border-radius: 2px;
    }

    .vehicle-details-section__head-price p {
        font-size: 14px;
        color: #666;
        margin-top: 5px;
    }

    .vehicle-card {
        background-color: #ffffff;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        border-radius: 8px;
        overflow: hidden;
        margin-bottom: 20px;
        padding: 20px; /* Added padding */
        max-width: 800px; /* Adjusted max-width to control size */
        margin: 0 auto; /* Center the vehicle-card */
    }

    .vehicle-gallery {
        width: 100%;
        height: auto;
        position: relative;
        overflow: hidden;
    }

    .vehicle-gallery img {
        width: 100%;
        height: auto;
        object-fit: cover;
        border-radius: 5px;
        cursor: pointer;
    }

    .thumbnail-images {
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        padding: 10px;
    }

    .thumbnail-images img {
        width: 180px; /* Thumbnail width */
        height: 150px; /* Thumbnail height */
        object-fit: cover;
        border-radius: 5px;
        margin: 5px;
        cursor: pointer;
    }

    .thumbnail-images img:hover {
        opacity: 0.7; /* Reduce opacity on hover */
    }

    .seller-details {
        background-color: #f8f9fa;
        padding: 20px;
        border-radius: 5px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        margin-bottom: 20px;
    }

    .seller-details h2 {
        margin-top: 0;
        font-weight: bold;
    }

    .seller-details p {
        margin-bottom: 5px;
    }

    .seller-card {
        background-color: #ffffff;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        border-radius: 8px;
        padding: 20px;
        margin-bottom: 20px;
    }

    .seller-card h2 {
        font-size: 24px;
        margin-top: 0;
        margin-bottom: 15px;
        font-weight: bold;
        color: #000; /* Ensure seller card title color is black */
        font-family: 'Open Sans', 'Titillium Web', 'PT Sans', Arial, sans-serif; /* Apply desired font */
    }

    .seller-card p {
        margin-bottom: 5px;
        color: #000; /* Ensure seller card text color is black */
        font-family: 'Open Sans', 'Titillium Web', 'PT Sans', Arial, sans-serif; /* Apply desired font */
    }

    .modal-background {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        z-index: 1;
        border-radius: 20px;
    }

    .modal-dialog {
        max-width: 800px;
        border-radius: 20px;
        background: url('https://images.frandroid.com/wp-content/uploads/2016/02/google_car.jpg') no-repeat center center;
        background-size: cover;
        position: relative;
    }

    .modal-content {
        background-color: rgba(255, 255, 255, 0.9);
        border-radius: 20px;
        padding: 20px;
        position: relative;
        z-index: 2;
    }

    .modal-header {
        border-bottom: none;
    }

    .modal-body {
        text-align: center;
    }

    .modal-header .close {
        color: #fff; /* Close button color */
    }

    .modal-body p {
        color: #000; /* Ensure modal body text color is black */
        font-family: 'Open Sans', 'Titillium Web', 'PT Sans', Arial, sans-serif; /* Apply desired font */
    }

    .max-bid-section {
        text-align: left;
        margin: 20px 0;
    }

    .max-bid-label {
        font-size: 16px;
        text-align: left;
        margin-bottom: 10px;
        color: #000; /* Change text color to black */
        font-family: 'Open Sans', 'Titillium Web', 'PT Sans', Arial, sans-serif; /* Apply desired font */
    }

    .max-bid-input {
        display: flex;
        align-items: center;
        border-radius: 10px;
        overflow: hidden;
    }

    .max-bid-currency {
        font-weight: bold;
        margin-right: 5px;
        font-family: 'Open Sans', 'Titillium Web', 'PT Sans', Arial, sans-serif; /* Apply desired font */
    }

    .terms {
        font-size: 12px;
        color: #888;
        margin: 0;
        font-family: 'Open Sans', 'Titillium Web', 'PT Sans', Arial, sans-serif; /* Apply desired font */
    }

    .reserve-status {
        font-size: 16px;
        font-weight: bold;
        text-align: left;
        color: #000; /* Ensure reserve status text color is black */
        font-family: 'Open Sans', 'Titillium Web', 'PT Sans', Arial, sans-serif; /* Apply desired font */
    }

    .bids-total {
        font-size: 16px;
        font-weight: bold;
        text-align: right;
        color: #000; /* Ensure bids total text color is black */
        font-family: 'Open Sans', 'Titillium Web', 'PT Sans', Arial, sans-serif; /* Apply desired font */
    }

    .time-remaining {
        display: flex;
        justify-content: center;
        align-items: center;
        margin: 20px 0;
        font-size: 24px;
        font-weight: bold;
    }

    .time-remaining span {
        margin: 0 5px;
    }

    .time-labels {
        display: flex;
        justify-content: center;
        font-size: 12px;
        color: #888;
    }

    .time-labels span {
        margin: 0 5px;
    }

    .bid-values {
        display: flex;
        justify-content: space-around;
        margin: 20px 0;
    }
    .bid-value {
        background-color: #ADCCE9;
        border: none;
        color: white;
        padding: 10px 20px;
        text-align: center;
        text-decoration: none;
        display: inline-block;
        font-size: 14px;
        margin: 4px 2px;
        cursor: pointer;
        border-radius: 10px;
        transition: background-color 0.3s ease;
        width: 145px;
        height: 42px;
        font-family: 'Open Sans', 'Titillium Web', 'PT Sans', Arial, sans-serif; /* Apply desired font */
    }

    .bid-value:hover {
        background-color: #77AAD9;
    }

    .form-control {
        margin: 0;
        border-radius: 0;
        border-top-left-radius: 10px;
        border-bottom-left-radius: 10px;
    }

    .btn-custom {
        margin-bottom: 20px;
        border-radius: 10px; /* Soft edges */
        transition: background-color 0.3s ease;
        width: 100%; /* Full width */
        display: block;
        height: 42px; /* Same height for consistency */
        font-family: 'Open Sans', 'Titillium Web', 'PT Sans', Arial, sans-serif; /* Apply desired font */
    }

    .max-bid-section {
        text-align: left;
        margin: 20px 0;
    }

    .max-bid-label {
        font-size: 16px;
        text-align: left;
        margin-bottom: 10px;
        color: #000; /* Change text color to black */
        font-family: 'Open Sans', 'Titillium Web', 'PT Sans', Arial, sans-serif; /* Apply desired font */
    }

    .max-bid-input {
        display: flex;
        align-items: center;
        border-radius: 10px;
        overflow: hidden;
    }

    .max-bid-currency {
        font-weight: bold;
        margin-right: 5px;
        font-family: 'Open Sans', 'Titillium Web', 'PT Sans', Arial, sans-serif; /* Apply desired font */
    }

    .terms {
        font-size: 12px;
        color: #888;
        margin: 0;
        font-family: 'Open Sans', 'Titillium Web', 'PT Sans', Arial, sans-serif; /* Apply desired font */
    }

    .reserve-status {
        font-size: 16px;
        font-weight: bold;
        text-align: left;
        color: #000; /* Ensure reserve status text color is black */
        font-family: 'Open Sans', 'Titillium Web', 'PT Sans', Arial, sans-serif; /* Apply desired font */
    }

    .bids-total {
        font-size: 16px;
        font-weight: bold;
        text-align: right;
        color: #000; /* Ensure bids total text color is black */
        font-family: 'Open Sans', 'Titillium Web', 'PT Sans', Arial, sans-serif; /* Apply desired font */
    }

    .time-remaining {
        display: flex;
        justify-content: center;
        align-items: center;
        margin: 20px 0;
        font-size: 24px;
        font-weight: bold;
    }

    .time-remaining span {
        margin: 0 5px;
    }

    .time-labels {
        display: flex;
        justify-content: center;
        font-size: 12px;
        color: #888;
    }

    .time-labels span {
        margin: 0 5px;
    }

    .bid-values {
        display: flex;
        justify-content: space-around;
        margin: 20px 0;
    }

    .bid-value {
        background-color: #ADCCE9;
        border: none;
        color: white;
        padding: 10px 20px;
        text-align: center;
        text-decoration: none;
        display: inline-block;
        font-size: 14px;
        margin: 4px 2px;
        cursor: pointer;
        border-radius: 10px;
        transition: background-color 0.3s ease;
        width: 145px;
        height: 42px;
        font-family: 'Open Sans', 'Titillium Web', 'PT Sans', Arial, sans-serif; /* Apply desired font */
    }

    .bid-value:hover {
        background-color: #77AAD9;
    }

    .form-control {
        margin: 0;
        border-radius: 0;
        border-top-left-radius: 10px;
        border-bottom-left-radius: 10px;
    }

    .btn-custom {
        margin-bottom: 20px;
        border-radius: 10px; /* Soft edges */
        transition: background-color 0.3s ease;
        width: 100%; /* Full width */
        display: block;
        height: 42px; /* Same height for consistency */
        font-family: 'Open Sans', 'Titillium Web', 'PT Sans', Arial, sans-serif; /* Apply desired font */
    }

    .max-bid-section {
        text-align: left;
        margin: 20px 0;
    }

    .max-bid-label {
        font-size: 16px;
        text-align: left;
        margin-bottom: 10px;
        color: #000; /* Change text color to black */
        font-family: 'Open Sans', 'Titillium Web', 'PT Sans', Arial, sans-serif; /* Apply desired font */
    }

    .max-bid-input {
        display: flex;
        align-items: center;
        border-radius: 10px;
        overflow: hidden;
    }

    .max-bid-currency {
        font-weight: bold;
        margin-right: 5px;
        font-family: 'Open Sans', 'Titillium Web', 'PT Sans', Arial, sans-serif; /* Apply desired font */
    }

    .terms {
        font-size: 12px;
        color: #888;
        margin: 0;
        font-family: 'Open Sans', 'Titillium Web', 'PT Sans', Arial, sans-serif; /* Apply desired font */
    }

    .reserve-status {
        font-size: 16px;
        font-weight: bold;
        text-align: left;
        color: #000; /* Ensure reserve status text color is black */
        font-family: 'Open Sans', 'Titillium Web', 'PT Sans', Arial, sans-serif; /* Apply desired font */
    }

    .bids-total {
        font-size: 16px;
        font-weight: bold;
        text-align: right;
        color: #000; /* Ensure bids total text color is black */
        font-family: 'Open Sans', 'Titillium Web', 'PT Sans', Arial, sans-serif; /* Apply desired font */
    }

    .time-remaining {
        display: flex;
        justify-content: center;
        align-items: center;
        margin: 20px 0;
        font-size: 24px;
        font-weight: bold;
    }

    .time-remaining span {
        margin: 0 5px;
    }

    .time-labels {
        display: flex;
        justify-content: center;
        font-size: 12px;
        color: #888;
    }

    .time-labels span {
        margin: 0 5px;
    }

    .bid-values {
        display: flex;
        justify-content: space-around;
        margin: 20px 0;
    }

    .bid-value {
        background-color: #ADCCE9;
        border: none;
        color: white;
        padding: 10px 20px;
        text-align: center;
        text-decoration: none;
        display: inline-block;
        font-size: 14px;
        margin: 4px 2px;
        cursor: pointer;
        border-radius: 10px;
        transition: background-color 0.3s ease;
        width: 145px;
        height: 42px;
        font-family: 'Open Sans', 'Titillium Web', 'PT Sans', Arial, sans-serif; /* Apply desired font */
    }

    .bid-value:hover {
        background-color: #77AAD9;
    }

    .form-control {
        margin: 0;
        border-radius: 0;
        border-top-left-radius: 10px;
        border-bottom-left-radius: 10px;
    }

    .btn-custom {
        margin-bottom: 20px;
        border-radius: 10px; /* Soft edges */
        transition: background-color 0.3s ease;
        width: 100%; /* Full width */
        display: block;
        height: 42px; /* Same height for consistency */
        font-family: 'Open Sans', 'Titillium Web', 'PT Sans', Arial, sans-serif; /* Apply desired font */
    }
</style>
{% endblock %}

{% block content %}
<div class="vehicle-details">
    <div class="vehicle-header">
        <img src="https://www.freewebheaders.com/wp-content/gallery/cars/cache/toyota-gt86-dashboard-car-website-header.jpg-nggid043742-ngg0dyn-1280x375x100-00f0w010c010r110f110r010t010.jpg" alt="Vehicle Details Page">
             <div class="vehicle-overlay">Vehicle Details Page</div>
    </div>
</div>

<section class="vehicle-details-section">
    <div class="container">
        <div class="row">
            <div class="col-md-9">
                <div class="vehicle-details-section__head">
                    <div class="vehicle-details-section__head-title">
                        <h1>{{ vehicle.model }}</h1>
                        <h3>{{ vehicle.year }}</h3>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="vehicle-details-section__head-price">
                    <div class="vehicle-details-section__head-price-num">LKR {{ highest_bid }}</div>
                    <p>Last Bid Price</p>
                </div>
            </div>
        </div>
    </div>
</section>

<div class="container">
    <div class="row">
        <div class="col-md-7">
            <div class="vehicle-card">
                <div class="vehicle-gallery">
                    <img id="main-image" src="{{ vehicle.picture.url }}" class="img-fluid" alt="{{ vehicle.model }}">
                </div>
                <div class="thumbnail-images">
                    {% for image in vehicle.additional_images.all %}
                        <img src="{{ image.url }}" alt="{{ vehicle.model }}" onclick="displayImage('{{ image.url }}')">
                    {% endfor %}
                    <!-- Display additional images -->
                    <img src="{{ vehicle.picture2.url }}" alt="Additional Image 1" onclick="displayImage('{{ vehicle.picture2.url }}')">
                    <img src="{{ vehicle.picture3.url }}" alt="Additional Image 2" onclick="displayImage('{{ vehicle.picture3.url }}')">
                </div>
            </div>
        </div>
        <div class="col-md-5">
            <div class="seller-card">
                <h3>Seller Details: </h3>
                <h5>Name: {{ vehicle.seller.first_name }} {{ vehicle.seller.last_name }}</h5>
                <p>Trading Address: {{ vehicle.seller.trading_address }}</p>
                <p>Email: {{ vehicle.seller.email }}</p>
                <p>Contact Number: {{ vehicle.seller.mobile_number }}</p>
            </div>
            <button class="btn btn-primary btn-custom" id="placeBidButton">Place Bid</button>
            <button class="btn btn-outline-secondary btn-custom" id="addToWatchListButton">Add To Watch List</button>
        </div>
    </div>

    <div class="row mt-3">
        <div class="col-md-12">
            <p>{{ vehicle.description }}</p>
        </div>
    </div>

    <div class="modal fade" id="placeBidModal" tabindex="-1" role="dialog" aria-labelledby="placeBidModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-background"></div>
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title"><b>Place Your Bid</b></h4>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <p class="vehicle-name"><b>{{ vehicle.model }} {{ vehicle.year }}</b></p>
                    <p class="vehicle-price">LKR {{ highest_bid }}</p>
                    <p class="item-description">Read the item description or contact seller for shipping information.</p>
                    <div class="info-row">
                        <p class="reserve-status">RESERVE NOT YET MET.</p>
                        <p class="bids-total">BIDS IN TOTAL FOR VEHICLE</p>
                    </div>
                    <div class="time-remaining">
                        <span>6</span> : <span>23</span> : <span>36</span> : <span>49</span>
                        <div class="time-labels">
                            <span>DAYS</span>
                            <span>HOURS</span>
                            <span>MINUTES</span>
                            <span>SECONDS</span>
                        </div>
                    </div>
                    <div class="bid-values">
                        {% for bid_value in bid_increments %}
                            <button class="bid-value" type="button" onclick="setBidValue({{ bid_value }})">LKR {{ bid_value }}</button>
                        {% endfor %}
                    </div>
                    <div class="max-bid-section">
                        <p class="max-bid-label">Or Enter Your Maximum Bid:</p>
                        <form method="post" action="{% url 'vehicle_detail' vehicle.id %}">
                            {% csrf_token %}
                            <div class="max-bid-input">
                                <span class="max-bid-currency">LKR</span>
                                {{ form.amount }}
                            </div>

                            <button class="btn btn-primary btn-block mb-3" id="placeBidModalButton">Place Bid</button>
                        </form>
                    <p class="terms mt-3">
                        By placing a bid, you express consent to share your contact information with the seller and authorizing the seller to contact you regarding this vehicle. And if this bid wins, you are purchasing this item and legally required to make a payment before THE DATE. The item will be sent once payment is completed.
                    </p>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    function displayImage(imageUrl) {
        document.getElementById('main-image').src = imageUrl;
    }

    document.addEventListener('DOMContentLoaded', function() {
        var placeBidButton = document.getElementById('placeBidButton');
        placeBidButton.addEventListener('click', handlePlaceBidClick);
    });

    function handlePlaceBidClick() {
        // Pass the is_authenticated value from the server to JavaScript
        var isAuthenticated = '{{ is_authenticated|yesno:"True,False" }}';

        if (isAuthenticated === 'True') {
            // Show the "Place Bid" modal
            $('#placeBidModal').modal('show');
        } else {
            // Redirect to the login page with the next parameter
            var loginUrl = '{% url "login" %}?next={{ request.path }}';
            window.location.href = loginUrl;
        }
    }
        function setBidValue(value) {
        document.getElementById('id_amount').value = value;
    }
</script>

{% endblock %}