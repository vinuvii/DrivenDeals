{% extends 'base.html' %}
{% load static %}
{% load humanize %}
{% block extra_head %}
<style>
html, body {
    overflow-x: hidden;
    font-family: 'Open Sans', 'Titillium Web', 'PT Sans', Arial, sans-serif;
}

.vehicle-details {
    width: 100%;
    height: auto;
}

.vehicle-header {
    width: 100%;
    height: 300px; /* Adjust height as needed */
    overflow: hidden;
    position: relative;
    margin-top: -150px;
}

.background-image {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-size: cover;
    background-position: center;
}

.overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.5); /* Adjust opacity as desired */
}

.vehicle-overlay {
    font-family: 'Open Sans', 'Titillium Web', 'PT Sans', Arial, sans-serif;
    position: absolute;
    top: 180px;
    left: 180px;
    color: white;
    padding: 5px 10px;
    font-size: 36px;
    font-weight: bold;
    z-index: 10;
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8); /* Optional: Add text shadow for better contrast */
}

.vehicle-details-section {
    background-color: #f9f9f9;
    padding: 60px 60px 120px; /* Increased bottom padding for huge space */
}

.vehicle-details-section__head-title {
    position: relative;
    font-size: 45px;
    font-weight: bold;
    text-transform: uppercase;
    margin-top: 40px;
    font-family: 'Open Sans', 'Titillium Web', 'PT Sans', Arial, sans-serif;
}

.vehicle-details-section__head-title::before {
    content: '';
    position: absolute;
    top: 0;
    left: -20px; /* Adjust this value to control the distance from the text */
    width: 5px; /* Adjust this value to control the thickness of the line */
    height: 100%;
    background-color: #de483d; /* Red color */
}

.vehicle-details-section__head h1,
.vehicle-details-section__head h3 {
    margin: 10px 0;
    padding-left: 10px;
}

.vehicle-details-section__head-price {
    text-align: right;
    margin-top: 40px; /* Increase spacing between price and buttons */
}

.vehicle-details-section__head-price-num {
    font-size: 30px;
    font-weight: bold;
    color: #ffffff;
    background-color: #de483d; /* Background color */
    display: inline-block;
    padding: 10px 25px;
    border-radius: 2px;
}

.vehicle-details-section__head-price p {
    font-size: 14px;
    color: #666;
    margin-top: 5px;
}

.button-group {
    margin-top: 40px; /* Add significant spacing between buttons */
}

#placeBidButton {
    background-color: #de483d; /* Primary button background color */
    border: #de483d;
    color: white;
    padding: 10px 20px;
    text-align: center;
    text-decoration: none;
    display: inline-block;
    font-size: 16px;
    margin: 4px 2px;
    cursor: pointer;
    border-radius: 5px;
}

#placeBidButton:hover {
    background-color:  #e68883; /* Darker shade for hover */
    border: none;
    color: white;
}

#watchlistButton {
    background-color: #f0f0f0; /* Outline secondary button background color */
    border: 1px solid #6c757d; /* Outline border color */
    color: #6c757d; /* Outline secondary button text color */
    padding: 10px 20px;
    text-align: center;
    text-decoration: none;
    display: inline-block;
    font-size: 16px;
    margin: 4px 2px;
    cursor: pointer;
    border-radius: 5px;
}

#watchlistButton:hover {
    background-color: #e5e5ea; /* Slightly darker background for hover */
    border: 1px solid #5a6268; /* Darker outline for hover */
    color: #5a6268; /* Darker text color for hover */
}

#watchlistButton .fa-check {
    color: green;
}

#watchlistButton .fa-star {
    color: gold;
}

.page-container {
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100%; /* Full height of viewport */
}

.vehicle-bids-card {
    position: relative;
    background-color: #ffffff;
    margin-bottom: 100px;
    padding: 15px;
    border-radius: 8px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    overflow: hidden;
    width: 100%;
    max-width: 1150px;
    border: 4px solid #dddddd; /* Border color similar to previous examples */
    margin-top: 10px;
}

.vehicle-bids-card p {
    margin-bottom: 12px;
    font-size: 0.95rem;
    color: #333;
    line-height: 1.6;
    border-bottom: 3px solid #dddddd;/* Similar border as before */
    padding-bottom: 3px;
    font-family: 'Open Sans', 'Titillium Web', 'PT Sans', Arial, sans-serif;
}

.vehicle-bids-card .place-bid-button-container {
    position: absolute;
    top: 10px;
    right: 30px;
    border-radius: 1px;
}

.vehicle-bids-card .btn-sm {
    font-size: 0.75rem;
    padding: 0.25rem 0.5rem;
}

.bid-table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 20px;
    max-width: 1050px; /* Adjust maximum width as per your design */
    margin-left: auto;
    margin-right: auto;
    display: table; /* Use 'table' instead of 'block' for proper centering */
}


.bid-table th, .bid-table td {
    border: none;
    padding: 16px 20px;
    text-align: left;
    vertical-align: top;
}

.bid-table th {
    background-color: #fdeaea; /* Very light shade of #de483d */
    font-weight: bold;
    border-radius: 8px 8px 0 0;
    padding: 12px 20px;
    font-family: 'Open Sans', 'Titillium Web', 'PT Sans', Arial, sans-serif;
}

.bid-table td {
    background-color: #fafafa;
    margin-bottom: 10px;
    border-radius: 0 0 8px 8px;
    padding: 12px 20px;
    font-family: 'Open Sans', 'Titillium Web', 'PT Sans', Arial, sans-serif;
}

.bid-table .status-label {
    font-weight: bold;
    padding: 2px 6px;
    border-radius: 3px;
    font-family: 'Open Sans', 'Titillium Web', 'PT Sans', Arial, sans-serif;
}

.bid-table .pending {
    background-color: #ff9800;
    color: #fff;
}

.bid-table .accepted {
    background-color: #4caf50;
    color: #fff;
}

.bid-table .rejected {
    background-color: #f44336;
    color: #fff;
}




/* Animation classes */
.animate__animated {
    animation-duration: 1s;
}

.animate__fadeIn {
    animation-name: fadeIn;
}

.animate__fadeInUp {
    animation-name: fadeInUp;
}

@keyframes fadeIn {
    from {
        opacity: 0;
    }
    to {
        opacity: 1;
    }
}

@keyframes fadeInUp {
    from {
        opacity: 0;
        transform: translateY(20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}




    #vehicle-details-container {
        background-color: #f9f9f9;
        padding: 20px;
        margin-top: -80px
    }
    #vehicle-details-container .vehicle-card {
        background-color: #ffffff;
        box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2); /* Adjusted shadow */
        border: 1px solid rgba(0, 0, 0, 0.1); /* Darker border */
        border-radius: 8px;
        overflow: hidden;
        margin-bottom: 20px;
        padding: 20px; /* Added padding */
        max-width: 800px; /* Adjusted max-width to control size */
        max-height: 805px; /* Adjusted max-height */
        margin: 0 auto; /* Center the vehicle-card */
        position: relative;
        transition: transform 0.3s ease-in-out;
    }

#vehicle-details-container .vehicle-card:hover {
    transform: translateY(-10px); /* Slight lift on hover */
}

    #vehicle-details-container .vehicle-gallery {
        width: 100%;
        height: auto;
        position: relative;
        overflow: hidden;
    }

    #vehicle-details-container .vehicle-gallery img {
        width: 100%;
        height: auto;
        object-fit: cover;
        border-radius: 5px;
        cursor: pointer;
        max-width: 760px; /* Adjusted max-width to control size */
        min-width: 760px;
        max-height: 570px;
        min-height: 570px;
        transition: transform 0.3s ease-in-out;
    }
    #vehicle-details-container .vehicle-gallery img:hover {
    transform: scale(1.05); /* Slight zoom on hover */
}

    #vehicle-details-container .thumbnail-images {
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        padding: 10px;
        margin-top: 25px;
    }

    #vehicle-details-container .thumbnail-images img {
        width: 180px; /* Thumbnail width */
        height: 150px; /* Thumbnail height */
        object-fit: cover;
        border-radius: 5px;
        margin: 5px;
        cursor: pointer;
        transition: opacity 0.3s ease-in-out, transform 0.3s ease-in-out;
    }

    #vehicle-details-container .thumbnail-images img:hover {
        opacity: 0.7;
        transform: translateY(-5px);
    }

.vehicle-description-card {
    padding-top: 0;
    padding-bottom: 0;
    margin-top: 0;
    margin-bottom: 20px;
    width: 100%;
    max-width: 550px;
    margin-right: 20px;
    background-color: #f9f9f9;
    border-radius: 8px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    overflow: hidden;
    border: 5px solid #f9f9f9;
}

.vehicle-description-card .card-header {
    background-color: #f9f9f9;
    padding: 20px;
    border-bottom: none;
    position: relative;
}

.vehicle-description-card .card-title {
    color: #000000;
    font-size: 1.3rem;
    font-weight: bold;
    position: relative;
    display: inline-block;
    background-color: transparent;
    border: none;
    padding-left: 25px;
}

.vehicle-description-card .card-title::before {
    content: "| ";
    color: #de483d;
    font-size: 2.0rem;
    font-weight: bold;
    position: absolute;
    left: 0;
    top: 50%;
    transform: translateY(-50%);
}

.vehicle-description-card .card-title span {
    display: inline-block;
    background-color: #f9f9f9;
}

.vehicle-description-card .card-body {
    padding: 0;
}

.table th::before,
.table td::before {
    content: "|";
    color: #999999;
    margin-right: 8px;
    font-size: 1.2rem;
    font-weight: bold;
}

.table th,
.table td {
    background-color: #f9f9f9;
    color: #333;
    border: none; /* Remove all borders */
    padding: 10px;
}

.vehicle-description-card .table {
    background-color: #f9f9f9;
    margin-bottom: 0;
    border-collapse: collapse;
}

.vehicle-description-card .table th,
.vehicle-description-card .table td {
    padding: 19px;
    color: #333;
}

.vehicle-description-card .table th {
    color: #000000;
    text-align: left;
    font-weight: normal;
}

.vehicle-description-card .table td {
    background-color: #f9f9f9;
    color: #000000;
    font-weight: bold;
}

.vehicle-description-card .table tr {
    background-color: #f9f9f9; /* Set background color for all rows */
}

.vehicle-description-card .table tr:hover {
    background-color: #f5f5f5;
    transition: background-color 0.3s ease;
}

.seller-description-card {
    background: linear-gradient(to bottom right, #ffffff, #f9f9f9); /* Subtle gradient background */
    margin-bottom: 20px;
    padding: 8px; /* Increased padding for better spacing */
    border-radius: 12px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1); /* Enhanced box shadow */
    overflow: hidden;
    width: 100%;
    max-width: 550px;
    max-height: 325px;
    margin-right: 20px;
    transition: transform 0.3s ease; /* Example animation */
}
.seller-description-card .card {
    border: 5px solid #dddddd;
    border-radius: 10px; /* Rounded border */
    overflow: hidden; /* Ensure content doesn't overflow */
}

.seller-description-card:hover {
    transform: translateY(-5px); /* Example hover animation */
}

.seller-description-card .card-header {
    background-color: transparent;
    padding: 15px;
    border-bottom: none;
    border-radius: 12px 12px 0 0; /* Rounded top corners */
}

.seller-description-card .card-title {
    color: #000000; /* Black font color */
    font-size: 1.5rem; /* Larger font size */
    font-weight: bold;
    margin: 0;
    position: relative; /* Ensure relative positioning */
    margin-left: 20px; /* Adjust margin as needed */
    font-family: 'Open Sans', 'Titillium Web', 'PT Sans', Arial, sans-serif;
}

.seller-description-card .card-title::before {
    content: "| ";
    color: #de483d;
    font-size: 2.0rem; /* Adjust size as needed */
    font-weight: bold;
    position: absolute;
    left: -20px; /* Position the bar to the left of the title */
    top: 50%;
    transform: translateY(-50%);
}
}

.seller-description-card .card-body {
    padding: 15px; /* Increased padding */
    border: 15px solid #ccc;

}

.seller-description-card p {
    margin-bottom: 12px;
    font-size: 1rem; /* Slightly larger font size */
    color: #555; /* Darker text color for readability */
    line-height: 1.6;
    font-family: 'Open Sans', 'Titillium Web', 'PT Sans', Arial, sans-serif;
}

.seller-description-card p strong {
    color: #de483d;
    font-family: 'Open Sans', 'Titillium Web', 'PT Sans', Arial, sans-serif;
}

.seller-description-card a {
    display: inline-block;
    color: #ffffff;
    background-color: #de483d;
    padding: 10px 15px;
    border-radius: 5px;
    text-decoration: none;
    font-weight: bold;
    transition: background-color 0.3s ease, color 0.3s ease;
    font-family: 'Open Sans', 'Titillium Web', 'PT Sans', Arial, sans-serif;
}

.seller-description-card a:hover {
    color: #de483d;
}

.seller-description-card .icon {
    margin-right: 10px; /* Space between icon and text */
    color: #de483d; /* Icon color */
}

.seller-description-card .seller-listings-link {
    color: #b03027;  /* Darker text color */
    text-decoration: underline;
    transition: color 0.3s ease, text-decoration 0.3s ease;
    background-color: transparent;
}




.modal-dialog {
    max-width: 800px;
    width: 100%;
    border-radius: 20px;
    position: relative;
}

#placeBidModalButton {
    margin-bottom: 30px;
    margin-top: 5px;
}
.modal-content {
    border-radius: 20px;
    padding: 20px;
    background: rgba(255, 255, 255, 0.9);
    position: relative;
    z-index: 2;
    min-height: 650px;
}

.modal-dialog::before {
    content: '';
    display: block;
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: url('https://images.frandroid.com/wp-content/uploads/2016/02/google_car.jpg') no-repeat center center;
    background-size: cover;
    border-radius: 20px;
    z-index: 1;
    opacity: 0.5;
}

.modal-header {
    border-bottom: none;
    position: relative;
    z-index: 2;
}

.modal-header .close {
    color: #fff;
}

.modal-body {
    text-align: center;
    position: relative;
    z-index: 2;
}

.modal-body p {
    color: #000;
    font-family: 'Open Sans', 'Titillium Web', 'PT Sans', Arial, sans-serif;
}

.max-bid-section {
    text-align: left;
    margin: 20px 0;
    padding-bottom: 10px;
    position: relative;
}

.max-bid-label {
    font-size: 16px;
    text-align: left;
    margin-bottom: 10px;
    color: #000;
    font-family: 'Open Sans', 'Titillium Web', 'PT Sans', Arial, sans-serif;
}

.max-bid-input {
    display: flex;
    align-items: center;
    border-radius: 10px;
    overflow: hidden;
    margin-bottom: 10px;
}

.max-bid-currency {
    font-weight: bold;
    margin-right: 5px;
    font-family: 'Open Sans', 'Titillium Web', 'PT Sans', Arial, sans-serif;
}

.terms {
    font-size: 12px;
    color: #888;
    margin: 0;  /* Adjusted margin to place it at the very bottom */
    position: absolute;
    bottom: 10px;  /* Small margin from the bottom */
    left: 20px;
    right: 20px;
    font-family: 'Open Sans', 'Titillium Web', 'PT Sans', Arial, sans-serif;
}

.reserve-status {
    font-size: 16px;
    font-weight: bold;
    text-align: left;
    color: #000;
    font-family: 'Open Sans', 'Titillium Web', 'PT Sans', Arial, sans-serif;
}

.bids-total {
    font-size: 16px;
    font-weight: bold;
    text-align: right;
    color: #000;
    font-family: 'Open Sans', 'Titillium Web', 'PT Sans', Arial, sans-serif;
}

.time-remaining {
    display: flex;
    justify-content: center;
    align-items: center;
    margin: 20px 0;
    font-size: 16px;
    font-weight: bold;
}

.time-remaining p {
    margin-bottom: 10px;
    font-weight: bold;
}

.time-unit {
    display: flex;
    flex-direction: column;
    align-items: center;
    margin: 0 5px;
}

.time-value {
    font-size: 2em;
    font-weight: bold;
}

.time-separator {
    font-size: 2em;
    font-weight: bold;
    margin: 0 5px;
}

.time-remaining span {
    margin: 0 5px;
}

.time-labels {
    display: flex;
    justify-content: center;
    font-size: 12px;
    color: #888;
}

.time-labels span {
    margin: 0 5px;
}

.bid-values {
    display: flex;
    justify-content: space-around;
    margin: 20px 0;
}

.bid-value {
    background-color: #e68186;
    border: none;
    color: white;
    padding: 10px 20px;
    text-align: center;
    text-decoration: none;
    display: inline-block;
    font-size: 14px;
    margin: 4px 2px;
    cursor: pointer;
    border-radius: 10px;
    transition: background-color 0.3s ease;
    width: 145px;
    height: 55px;
    font-family: 'Open Sans', 'Titillium Web', 'PT Sans', Arial, sans-serif;
}

.bid-value:hover {
    background-color: #f7b1b7;/* Light shade on hover */
}


.form-control {
    margin: 0;
    border-radius: 0;
    border-top-left-radius: 10px;
    border-bottom-left-radius: 10px;
}
.modal-header .close {
    color: #000;  /* Adjust the color as needed for visibility */
    position: absolute;
    top: 15px;
    right: 20px;
    font-size: 1.9rem;
    z-index: 3;  /* Ensure it's above other elements */
}
.info-row {
    display: flex; /* Display children elements in a row */
    justify-content: space-between; /* Distribute space between the children */
    align-items: center; /* Center-align items vertically */
    margin-top: 15px;
    margin-bottom: 15px;
}


    .btn-primary {
        background-color: #de483df; /* Primary color */
        border-color: #de483d; /* Primary border color */
        color: #fff;
    }

    .btn-primary:hover {
        background-color: #b23a31; /* Darker shade on hover */
        border-color: #b23a31; /* Darker border color on hover */
    }

    /* Outline secondary button styles */
    .btn-outline-secondary {
        background-color: transparent; /* Transparent background */
        border-color: #6c757d; /* Secondary border color */
        color: #6c757d; /* Secondary text color */
    }

    .btn-outline-secondary:hover {
        background-color: #6c757d; /* Background color on hover */
        color: #fff; /* Text color on hover */
    }

    /* Disabled button styles */
    .btn-outline-secondary:disabled {
        background-color: #e0e0e0; /* Disabled background color */
        border-color: #ccc; /* Disabled border color */
        color: #888; /* Disabled text color */
    }

    .btn-custom {
        margin-bottom: 20px;
        border-radius: 10px; /* Soft edges */
        transition: background-color 0.3s ease;
        width: 100%; /* Full width */
        display: block;
        height: 42px; /* Same height for consistency */
        font-family: 'Open Sans', 'Titillium Web', 'PT Sans', Arial, sans-serif; /* Apply desired font */
    }

    .btn-custom.btn-success {
        background-color: #28a745;
        border-color: #28a745;
        color: #fff;
    }

.vehicle-features {
    margin-top: 80px;
    margin-left: 20px;
    font-family: 'Open Sans', 'Titillium Web', 'PT Sans', Arial, sans-serif;
}

.vehicle-features h3 {
    font-size: 1.75rem; /* Increase font size */
    font-weight: bold; /* Make the text bold */
    margin-bottom: 20px; /* Adds space below the heading */
    color: #333; /* Sets a dark color for the heading text */
    margin-top: 20px;
    font-family: 'Open Sans', 'Titillium Web', 'PT Sans', Arial, sans-serif;
}

.vehicle-features ul {
    list-style-type: none;
    padding-left: 0;
    font-family: 'Open Sans', 'Titillium Web', 'PT Sans', Arial, sans-serif;
}
.vehicle-features li {
    margin-bottom: 12px;
    line-height: 1.8;
    font-family: 'Open Sans', 'Titillium Web', 'PT Sans', Arial, sans-serif;
}

.vehicle-features .fa-check-circle {
    margin-right: 10px;
    color: #de483d; /* Original color */
    font-size: 16px;
}

.vehicle-description {
    margin-top: 80px;
    margin-bottom: 100px;
    font-family: 'Open Sans', 'Titillium Web', 'PT Sans', Arial, sans-serif;
}

.vehicle-description .description-text p {
    text-align: justify; /* Justify the text */
    font-size: 16px; /* Example font size */
    line-height: 1.6; /* Example line height */
    margin-left: 20px; /* Example margin left */
    margin-right: 60px; /* Example margin right */
    font-family: 'Open Sans', 'Titillium Web', 'PT Sans', Arial, sans-serif;
}

.heading-with-bar {
    position: relative;
    padding-left: 20px;
    font-family: 'Open Sans', 'Titillium Web', 'PT Sans', Arial, sans-serif;
}

.heading-with-bar::before {
    content: '';
    position: absolute;
    left: 0;
    top: 0;
    bottom: 0;
    width: 5px; /* Adjust the width of the bar */
    background-color: #de483d; /* The color of the bar */
}




[data-aos] {
    opacity: 0;
    transition-property: opacity;
}

[data-aos].aos-animate {
    opacity: 1;
}

[data-aos^="fade"] {
    transition-duration: 800ms; /* Adjust duration as needed */
}



.btn-custom {
    font-weight: bold;
}

.btn-custom:disabled {
    background-color: #f4c7c3; /* Disabled button background color */
    color: #6c757d; /* Disabled button text color */
    cursor: not-allowed;
}

</style>
{% endblock %}



{% block content %}
<div class="vehicle-details" data-aos="fade-down" data-aos-duration="500" data-aos-delay="200">
    <div class="vehicle-header">
        <div class="background-image"
             style="background-image: url('https://www.freewebheaders.com/wp-content/gallery/cars/cache/toyota-gt86-dashboard-car-website-header.jpg-nggid043742-ngg0dyn-1280x375x100-00f0w010c010r110f110r010t010.jpg');">
            <div class="overlay"></div>
            <div class="vehicle-overlay">Vehicle Details Page</div>
        </div>
    </div>
</div>

<section class="vehicle-details-section">
    <div class="container">
        <div class="row">
            <div class="col-md-9">
                <div class="vehicle-details-section__head animate__animated animate__fadeInUp">
                    <div class="vehicle-details-section__head-title">
                        <h1>{{ vehicle.make }} - {{ vehicle.model }}</h1>
                        <h3>{{ vehicle.year }}</h3>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="vehicle-details-section__head-price animate__animated animate__fadeInUp">
                    <div class="vehicle-details-section__head-price-num">LKR {{ highest_bid|intcomma }}</div>
                    <p>Winning Bid Price</p>
                </div>
                <div class="button-group animate__animated animate__fadeInUp">
                    <div class="d-flex flex-column align-items-start">
                        <button class="btn btn-outline-secondary btn-custom mb-2" id="watchlistButton"
                            data-vehicle-id="{{ vehicle.id }}">
                            {% if is_in_watchlist %}
                                <i class="fas fa-check"></i> Added to Watchlist
                            {% else %}
                                <i class="far fa-star"></i> Add to Watchlist
                            {% endif %}
                        </button>

                        {% if auction_ended %}
                            <button class="btn btn-outline-secondary btn-custom" id="auctionEndedButton"
                                disabled>Auction Ended</button>
                        {% else %}
                            <button class="btn btn-primary btn-custom mb-2" id="placeBidButton">Place Bid</button>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>


<div id="vehicle-details-container" class="container" data-aos="fade-up">
  <div class="row">
    <div class="col-md-7">
      <div class="vehicle-card" data-aos="fade-up">
        <div class="vehicle-gallery">
          <img id="main-image" src="{{ vehicle.picture.url }}" class="img-fluid" alt="{{ vehicle.model }}">
        </div>
        <div class="thumbnail-images" data-aos="fade-up">
          <img src="{{ vehicle.picture.url }}" alt="{{ vehicle.model }}" onclick="displayImage('{{ vehicle.picture.url }}')">
          {% if vehicle.picture2 %}
            <img src="{{ vehicle.picture2.url }}" alt="Additional Image 1" onclick="displayImage('{{ vehicle.picture2.url }}')">
          {% endif %}
          {% if vehicle.picture3 %}
            <img src="{{ vehicle.picture3.url }}" alt="Additional Image 2" onclick="displayImage('{{ vehicle.picture3.url }}')">
          {% endif %}
          {% for image in vehicle.additional_images.all %}
            <img src="{{ image.url }}" alt="{{ vehicle.model }}" onclick="displayImage('{{ image.url }}')">
          {% endfor %}
        </div>
      </div>
    </div>

    <div class="col-md-5 d-flex flex-column" data-aos="fade-up">
      <div class="vehicle-description-card mb-3" data-aos="fade-up">
        <div class="card">
          <div class="card-header">
            <h5 class="card-title mb-0">Description</h5>
          </div>
          <div class="card-body">
            <table class="table table-striped">
              <tbody>
                <tr>
                  <th>Manufacturer</th>
                  <td>{{ vehicle.make }}</td>
                </tr>
                <tr>
                  <th>Model</th>
                  <td>{{ vehicle.model }}</td>
                </tr>
                <tr>
                  <th>Year</th>
                  <td>{{ vehicle.year }}</td>
                </tr>
                <tr>
                  <th>Color</th>
                  <td>{{ vehicle.color }}</td>
                </tr>
                <tr>
                  <th>Mileage</th>
                  <td>{{ vehicle.mileage }} km</td>
                </tr>
                <tr>
                  <th>Fuel Type</th>
                  <td>{{ vehicle.fuel_type | capfirst }}</td>
                </tr>
                <tr>
                  <th>Body Type</th>
                  <td>{{ vehicle.body_type | capfirst }}</td>
                </tr>
                <tr>
                  <th>Engine Capacity</th>
                  <td>{{ vehicle.engine_capacity }}</td>
                </tr>
                <tr>
                  <th>Engine Type</th>
                  <td>{{ vehicle.engine_type | capfirst }}</td>
                </tr>
                <tr>
                  <th>Transmission Type</th>
                  <td>{{ vehicle.transmission_type | capfirst }}</td>
                </tr>
                <tr>
                  <th>Number of Seats</th>
                  <td>{{ vehicle.no_of_seats }}</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
  </div>


<div class="row vehicle-features" data-aos="fade-up">
    <div class="col-md-7">
        <h3 class="heading-with-bar">Features</h3>
        <div class="feature-list">
            <div class="row">
                <div class="col-sm-6">
                    <ul>
                        <li>
                            {% if vehicle.abs_breaks %}
                                <i class="fas fa-check-circle"></i> ABS Breaks
                            {% endif %}
                        </li>
                        <li>
                            {% if vehicle.alloy_wheels %}
                                <i class="fas fa-check-circle"></i> Alloy Wheels
                            {% endif %}
                        </li>
                        <li>
                            {% if vehicle.airbags %}
                                <i class="fas fa-check-circle"></i> Airbags
                            {% endif %}
                        </li>
                        <li>
                            {% if vehicle.air_conditioning %}
                                <i class="fas fa-check-circle"></i> Air Conditioning
                            {% endif %}
                        </li>
                        <li>
                            {% if vehicle.power_steering %}
                                <i class="fas fa-check-circle"></i> Power Steering
                            {% endif %}
                        </li>
                    </ul>
                </div>
                <div class="col-sm-6">
                    <ul>
                        <li>
                            {% if vehicle.power_windows %}
                                <i class="fas fa-check-circle"></i> Power Windows
                            {% endif %}
                        </li>
                        <li>
                            {% if vehicle.central_locking %}
                                <i class="fas fa-check-circle"></i> Central Locking
                            {% endif %}
                        </li>
                        <li>
                            {% if vehicle.reverse_camera %}
                                <i class="fas fa-check-circle"></i> Reverse Camera
                            {% endif %}
                        </li>
                        <li>
                            {% if vehicle.sunroof %}
                                <i class="fas fa-check-circle"></i> Sunroof
                            {% endif %}
                        </li>
                        <li>
                            {% if vehicle.leather_seats %}
                                <i class="fas fa-check-circle"></i> Leather Seats
                            {% endif %}
                        </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="vehicle-description" data-aos="fade-up">
            <h3 class="heading-with-bar">Description</h3>
            <div class="description-text">
                <p>{{ vehicle.description }}</p>
            </div>
        </div>
    </div>


        <div class="seller-description-card" data-aos="fade-up">
            <div class="card">
                <div class="card-header">
                    <h5 class="card-title mb-0">Seller Details</h5>
                </div>
                <div class="card-body">
                    <p>
                        <strong><i class="fas fa-user icon"></i> Name:</strong>
                        {{ vehicle.seller.first_name }} {{ vehicle.seller.last_name }}
                    </p>
                    <p>
                        <strong><i class="fas fa-map-marker-alt icon"></i> Trading Address:</strong>
                        {{ vehicle.seller.trading_address }}
                    </p>
                    <p>
                        <strong><i class="far fa-envelope icon"></i> Email:</strong>
                        {{ vehicle.seller.email }}
                    </p>
                    <p>
                        <strong><i class="fas fa-phone-alt icon"></i> Contact Number:</strong>
                        {{ vehicle.seller.mobile_number }}
                    </p>
                    <p>
                        <strong><i class="fas fa-list-alt icon"></i><a href="{% url 'seller_listings' %}?seller_id={{ vehicle.seller.id }}" class="seller-listings-link">Click To Check Seller's Other Listings
                            </a>
                        </strong>
                    </p>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="page-container">
    <div class="vehicle-bids-card" data-aos="fade-up">
        <div id="time-remaining" style="font-size: 1.0rem; text-align: center; font-weight: bold;"></div>
        <div class="bidding-period">
            <div id="time-remaining-container1"></div>
        </div>

        <div>
            <h3 style="font-size: 1.9rem;"><strong>Highest Bid: {{ highest_bid }}</strong></h3>

            {% if highest_bid %}
                {% if remaining_time %}
                    <table class="bid-table">
                        <thead>
                            <tr>
                                <th>Bid Date & Time</th>
                                <th>Bidder</th>
                                <th>Bid Amount</th>
                                <th>Bid Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for bid in vehicle.bid_set.all %}
                                <tr>
                                    <td>
                                        <strong>{{ bid.timestamp|date:"Y-m-d" }}</strong> <i>{{ bid.timestamp|time:"H:i:s" }}</i>
                                    </td>
                                        <td>
                                            {% with bid.user.username as username %}
                                                {% with username|slice:":3" as visible_part %}
                                                    {{ visible_part }}{% if username|length > 3 %}***{% endif %}
                                                {% endwith %}
                                            {% endwith %}
                                        </td>
                                    <td style="font-weight: bold; color: #333;">
                                        LKR {{ bid.amount|floatformat:"2"|intcomma }}
                                    </td>
                                    <td>
                                        {% if bid.get_bid_status_display == 'Pending' %}
                                            <span style="background-color: #ff9800; color: #fff; font-weight: bold; padding: 2px 6px; border-radius: 3px;">{{ bid.get_bid_status_display }}</span>
                                        {% elif bid.get_bid_status_display == 'Accepted' %}
                                            <span style="background-color: #4caf50; color: #fff; font-weight: bold; padding: 2px 6px; border-radius: 3px;">{{ bid.get_bid_status_display }}</span>
                                        {% elif bid.get_bid_status_display == 'Rejected' %}
                                            <span style="background-color: #f44336; color: #fff; font-weight: bold; padding: 2px 6px; border-radius: 3px;">{{ bid.get_bid_status_display }}</span>
                                        {% endif %}
                                    </td>
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                {% else %}
                    {% if auction_ended %}
                        <table class="bid-table">
                            <thead>
                                <tr>
                                    <th>Bid Date & Time</th>
                                    <th>Bidder</th>
                                    <th>Bid Amount</th>
                                    <th>Bid Status</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for bid in vehicle.bid_set.all %}
                                    <tr>
                                        <td>
                                            <strong>{{ bid.timestamp|date:"Y-m-d" }}</strong> <i>{{ bid.timestamp|time:"H:i:s" }}</i>
                                        </td>
                                        <td>
                                            {% with bid.user.username as username %}
                                                {% with username|slice:":3" as visible_part %}
                                                    {{ visible_part }}{% if username|length > 3 %}***{% endif %}
                                                {% endwith %}
                                            {% endwith %}
                                        </td>
                                        <td style="font-weight: bold; color: #333;">
                                            LKR {{ bid.amount|floatformat:"2"|intcomma }}
                                        </td>
                                        <td>
                                            {% if bid.get_bid_status_display == 'Pending' %}
                                                <span style="background-color: #ff9800; color: #fff; font-weight: bold; padding: 2px 6px; border-radius: 3px;">{{ bid.get_bid_status_display }}</span>
                                            {% elif bid.get_bid_status_display == 'Accepted' %}
                                                <span style="background-color: #4caf50; color: #fff; font-weight: bold; padding: 2px 6px; border-radius: 3px;">{{ bid.get_bid_status_display }}</span>
                                            {% elif bid.get_bid_status_display == 'Rejected' %}
                                                <span style="background-color: #f44336; color: #fff; font-weight: bold; padding: 2px 6px; border-radius: 3px;">{{ bid.get_bid_status_display }}</span>
                                            {% endif %}
                                        </td>
                                    </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    {% else %}

                    {% endif %}
                {% endif %}
            {% endif %}
        </div>

        {% if not auction_ended %}
        <div class="place-bid-button-container">
            <button class="btn btn-primary btn-sm btn-custom place-bid-button" id="placeBidButtonSeller">Place Bid</button>
        </div>
        {% endif %}
    </div>
</div>

</div>



{% if not auction_ended %}
<div class="modal fade" id="placeBidModal" tabindex="-1" role="dialog" aria-labelledby="placeBidModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title"><b>Place Your Bid</b></h4><br>
                <button type="button" class="close" aria-label="Close" id="customCloseButton">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <p class="vehicle-name"><b>{{ vehicle.model }} {{ vehicle.year }}</b></p>
                <p class="vehicle-price">LKR {{ highest_bid|intcomma }}</p>
                <p class="item-description">Read the item description or contact seller for more information.</p>
                <div class="info-row">
                    <p class="reserve-status">RESERVE NOT YET MET</p>
                    <p class="bids-total">BIDS IN TOTAL FOR VEHICLE: {{ total_bids }}</p>
                </div>


                {% if remaining_time %}
                <p>Bidding Period Ends In,</p>
                {% else %}
                <p>Place The First Bid To Start Auction</p>
                {% endif %}
                <div id="time-remaining-container2"></div>

                    <div class="bid-values">

                        {% for bid_value in bid_increments %}
                            <button class="bid-value" type="button" onclick="setBidValue({{ bid_value }})">LKR {{ bid_value }}</button>
                        {% endfor %}
                    </div>
                <div class="max-bid-section">
                    <p class="max-bid-label">Or Enter Your Maximum Bid:</p>
                    <form method="post" action="{% url 'vehicle_detail' vehicle.id %}" id="bidForm">
                        {% csrf_token %}
                        <div class="max-bid-input">
                            <span class="max-bid-currency">LKR</span>
                            {{ form.amount }}
                        </div>
                        <button class="btn btn-primary btn-block mb-3" id="placeBidModalButton">Place Bid</button>
                    </form>
                </div>
                <p class="terms mt-3">
                    By placing a bid, you express consent to share your contact information with the seller and authorize the seller to contact you regarding this vehicle. If this bid wins, you are purchasing this item and legally required to purchase the vehicle.
                </p>
                </div>
            </div>
        </div>
    </div>




<div id="countdown-template" style="display: none;">
    <div class="time-remaining">
        <div class="time-unit">
            <span class="time-value" id="days"></span>
            <span class="time-label">DAYS</span>
        </div>
        <span class="time-separator">:</span>
        <div class="time-unit">
            <span class="time-value" id="hours"></span>
            <span class="time-label">HOURS</span>
        </div>
        <span class="time-separator">:</span>
        <div class="time-unit">
            <span class="time-value" id="minutes"></span>
            <span class="time-label">MINUTES</span>
        </div>
        <span class="time-separator">:</span>
        <div class="time-unit">
            <span class="time-value" id="seconds"></span>
            <span class="time-label">SECONDS</span>
        </div>
    </div>
    {% endif %}
</div>



<script>
document.addEventListener('DOMContentLoaded', function() {

    var closeButton = document.getElementById('customCloseButton');
    if (closeButton) {
        closeButton.addEventListener('click', function() {
            $('#placeBidModal').modal('hide');
        });
    }

        var bidIncrementButtons = document.querySelectorAll('.bid-value');
        bidIncrementButtons.forEach(button => {
            button.addEventListener('click', function() {
                setBidValue(this.textContent.replace('LKR ', ''));
            });
        });

    var remainingTime = {{ remaining_time|default:'null' }};

    var placeBidButton = document.getElementById('placeBidButton');
    placeBidButton.addEventListener('click', handlePlaceBidClick);

    var placeBidButtonSeller = document.getElementById('placeBidButtonSeller');
    placeBidButtonSeller.addEventListener('click', handlePlaceBidClick);

    var watchlistButton = document.getElementById('watchlistButton');
    watchlistButton.addEventListener('click', handleWatchlistClick);

    var bidForm = document.getElementById('bidForm');
    bidForm.addEventListener('submit', validateBid);

    // Countdown Initialization
    function initializeCountdown(selector, remainingSeconds) {
        var countdownElement = document.querySelector(selector);
        if (!countdownElement) return;

        var daysElem = countdownElement.querySelector('#days');
        var hoursElem = countdownElement.querySelector('#hours');
        var minutesElem = countdownElement.querySelector('#minutes');
        var secondsElem = countdownElement.querySelector('#seconds');

        function updateCountdown() {
            if (remainingSeconds <= 0) {
                countdownElement.innerHTML = "Auction Ended";
                return;
            }

            var days = Math.floor(remainingSeconds / 86400);
            var hours = Math.floor((remainingSeconds % 86400) / 3600);
            var minutes = Math.floor((remainingSeconds % 3600) / 60);
            var seconds = Math.floor(remainingSeconds % 60);

            daysElem.innerText = days;
            hoursElem.innerText = hours;
            minutesElem.innerText = minutes;
            secondsElem.innerText = seconds;

            remainingSeconds--;
            setTimeout(updateCountdown, 1000);
        }

        updateCountdown();
    }

    // Append Countdown Template
    if (remainingTime !== null) {
        document.getElementById('time-remaining').innerHTML = 'Bidding Period Ends In,';
        var countdownTemplate = document.getElementById('countdown-template').innerHTML;

        function appendCountdown(elementId) {
            var container = document.getElementById(elementId);
            if (container) {
                container.innerHTML += countdownTemplate;
            }
        }

        appendCountdown('time-remaining-container1');
        appendCountdown('time-remaining-container2');

        initializeCountdown('#time-remaining-container1 .time-remaining', remainingTime);
        initializeCountdown('#time-remaining-container2 .time-remaining', remainingTime);
    } else {
        document.getElementById('time-remaining').innerHTML = 'Place The First Bid To Start Auction';
    }

    // Place Bid Button Event Listener
    if (placeBidButton) {
        placeBidButton.addEventListener('click', handlePlaceBidClick);
    }

    if (placeBidButtonSeller) {
        placeBidButtonSeller.addEventListener('click', function() {
            var isAuthenticated = '{{ user.is_authenticated|yesno:"True,False" }}';

            if (isAuthenticated === 'True') {
                $('#placeBidModal').modal('show');
            } else {
                var loginUrl = '{% url "login" %}?next={{ request.path }}';
                window.location.href = loginUrl;
            }
        });
    }

    // Watchlist Button Event Listener
    if (watchlistButton) {
        watchlistButton.addEventListener('click', handleWatchlistClick);
    }

    // Bid Form Event Listener
    if (bidForm) {
        bidForm.addEventListener('submit', validateBid);
    }

    function handlePlaceBidClick() {
        var isAuthenticated = '{{ user.is_authenticated|yesno:"True,False" }}';

        if (isAuthenticated === 'True') {
            $('#placeBidModal').modal('show');
        } else {
            var loginUrl = '{% url "login" %}?next={{ request.path }}';
            window.location.href = loginUrl;
        }
    }

    function handleWatchlistClick() {
        var isAuthenticated = '{{ user.is_authenticated|yesno:"True,False" }}';
        var vehicleId = this.dataset.vehicleId;

        if (isAuthenticated === 'True') {
            fetch(`{% url 'toggle_watchlist' 0 %}`.replace('0', vehicleId), {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'X-CSRFToken': '{{ csrf_token }}'
                },
                body: JSON.stringify({ vehicle_id: vehicleId })
            })
            .then(response => response.json())
            .then(data => {
                if (data.added) {
                    this.innerHTML = '<i class="fas fa-check"></i> Added to Watchlist';
                    this.classList.remove('btn-outline-secondary');
                    this.classList.add('btn-success');
                } else {
                    this.innerHTML = '<i class="far fa-star"></i> Add to Watchlist';
                    this.classList.remove('btn-success');
                    this.classList.add('btn-outline-secondary');
                }
            });
        } else {
            var loginUrl = '{% url "login" %}?next={{ request.path }}';
            window.location.href = loginUrl;
        }
    }

    function setBidValue(value) {
        var bidInput = document.getElementById('id_amount');
        if (bidInput) {
            bidInput.value = value;
        }
    }

    function validateBid(event) {
        var highestBid = {{ highest_bid }};
        var bidInput = document.getElementById('id_amount');
        var bidValue = parseFloat(bidInput.value.replace(/,/g, ''));

        if (bidValue <= highestBid) {
            alert('Please enter a bid higher than the current highest bid.');
            event.preventDefault();
        }
    }
});

function displayImage(imageUrl) {
    document.getElementById('main-image').src = imageUrl;
}
</script>
{% endblock %}